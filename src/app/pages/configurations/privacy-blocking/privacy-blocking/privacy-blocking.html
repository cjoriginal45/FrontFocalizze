<app-header></app-header>

<div class="page-wrapper">
  <div class="watermark-container">
    <span class="watermark-text">FOCALIZZE</span>
  </div>

  <div class="settings-container">
    <header class="settings-header">
      <button mat-icon-button (click)="goBack()" class="back-button" aria-label="Volver">
        <mat-icon>arrow_back</mat-icon>
      </button>
      <h2 class="header-title">Bloqueo y Privacidad</h2>
    </header>

    <main class="content-area">
      <div class="subsection">
        <h3 class="section-title">Usuarios bloqueados</h3>

        <div class="blocked-list-card">
          <div class="custom-scroll-box">
            @for (user of blockedUsers(); track user.id) {
            <div
              class="blocked-user-row"
              [class.selected]="selectedUsernames.has(user.username)"
              (click)="toggleSelection(user.username)"
            >
              <img
                [src]="user.avatarUrl || 'assets/images/default-avatar.webp'"
                class="user-avatar"
                alt="Avatar"
              />
              <div class="user-info">
                <span class="display-name">{{ user.displayName }}</span>
                <span class="username">@{{ user.username }}</span>
              </div>
              @if (selectedUsernames.has(user.username)) {
              <mat-icon class="check-icon">check_circle</mat-icon>
              }
            </div>
            } @empty { @if (!isLoading()) {
            <div class="empty-state">
              <mat-icon>block</mat-icon>
              <p>No tienes usuarios bloqueados.</p>
            </div>
            } } @if (isLoading()) {
            <div class="loading-state">Cargando...</div>
            }
          </div>
        </div>
        <div class="actions-container" [class.visible]="selectedUsernames.size > 0">
          <button mat-flat-button class="btn-unblock" (click)="unblockSelectedUsers()">
            Desbloquear ({{ selectedUsernames.size }})
          </button>
        </div>
      </div>
    </main>
  </div>
</div>

<app-botton-nav></app-botton-nav>
