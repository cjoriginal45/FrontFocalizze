@if (threadSignal?.(); as thread) {

  <article class="thread">
    <!-- Mini Header del Hilo -->
    <header class="thread__header">
      <a routerLink="/profile/{{ thread.user.username }}" class="thread__user">
        <img [src]="thread.user.avatarUrl" alt="Avatar de {{ thread.user.displayName }}" class="thread__avatar">
        <div class="thread__user-info">
          <span class="thread__display-name">{{ thread.user.displayName }}</span>
          <span class="thread__username">@{{ thread.user.username }}</span>
        </div>
      </a>
      <span class="thread__date">{{ thread.publicationDate | date : 'd MMM' }}</span>
    </header>
  
    <!-- Cuerpo del Hilo -->
    <div class="thread__body" [class.thread__body--expanded]="isExpanded">
      <div class="thread__content">
        <!-- Post 1 (siempre visible) -->
        <div class="thread__post">
          <h3 class="thread__post-title">1° post</h3>
          <p class="thread__post-text">{{ thread.posts[0] }}</p>
        </div>
  
        <!-- Posts adicionales (visibles si está expandido) -->
        @if (isExpanded) {
          @if (isLoadingDetails) {
            <div class="thread__loading-spinner">Cargando...</div>
          } @else {
            @for (post of thread.posts.slice(1); track $index) {
              <div class="thread__post">
                <h3 class="thread__post-title">{{ $index + 2 }}° post</h3>
                <p class="thread__post-text">{{ post }}</p>
              </div>
            }
          }
        }
      </div>
  
      <!-- Botón de Expandir (visible si hay más de 1 post O si aún no se ha cargado por completo) -->
      @if (thread.posts.length > 1 || !isFullyLoaded) {
        <a (click)="toggleExpansion()" class="thread__expand-btn">
          @if (isLoadingDetails) {
            Cargando...
          } @else if (isExpanded) {
            Ocultar -
          } @else {
            Ampliar +
          }
        </a>
      }
    </div>
  
    <!-- Footer con Acciones -->
    <footer class="thread__footer">
      <!-- Acción: Me Gusta -->
      <div class="thread__action thread__action--like" (click)="toggleLike()" [class.thread__action--liked]="thread.isLiked">
        <mat-icon class="thread__icon">{{ thread.isLiked ? 'favorite' : 'favorite_border' }}</mat-icon>
        <span class="thread__counter">{{ thread.stats.likes | number }}</span>
      </div>
  
      <!-- Acción: Comentarios -->
      <div class="thread__action" (click)="onCommentClick()">
        <mat-icon class="thread__icon">chat_bubble_outline</mat-icon>
        <span class="thread__counter">{{ thread.stats.comments | number }}</span>
      </div>
  
      <!-- Acción: Visualizaciones -->
      <div class="thread__action">
        <mat-icon class="thread__icon">bar_chart</mat-icon>
        <span class="thread__counter">{{ thread.stats.views | number }}</span>
      </div>
  
      <!-- Acción: Guardar -->
      <div class="thread__action" (click)="toggleSave()">
        <mat-icon class="thread__icon">{{ thread.isSaved ? 'bookmark' : 'bookmark_border' }}</mat-icon>
        <span class="thread__counter">{{ thread.stats.saves | number }}</span>
      </div>
    </footer>
  </article>
  
  }